const cuentaRepository=new Repository("Cuenta"),transaccionRepository=new Repository("Transaccion");let mostrarModal=n=>{$(".modal").toggleClass("visible"),$("#tipoTransaccion").val(n),$("#concepto").html(`${n===1?"Depósito":"Retiro"} de efectivo`),$("#indicacion").html(`Indica la cantidad a ${n===1?"depositar":"retirar"}`),$("#guardar").html(n===1?"DEPOSITAR":"RETIRAR")},obtenerCuenta=()=>{cuentaRepository.httpGet("ObtenerDetalles",{id:$("#cuentaID").val()}).then(n=>{n.correct?n.data?($("#numeroCuenta").html(format(n.data.numeroCuenta)),$("#saldoCuenta").html(`$${currency(n.data.saldo)}`),swal.close()):info("No se encontraron resultados","No se encontró ninguna cuenta con el ID proporcionado"):requestError(n.message)}).catch(n=>{serviceError(`${n.status} - ${n.statusText}`)})},obtenerTransacciones=()=>{transaccionRepository.httpGet("ObtenerTransacciones",{id:$("#cuentaID").val()}).then(n=>{n.correct?n.data[0]&&($.each(n.data,function(n,t){$(".info__transactions tbody").append("<tr>"+`<td>${t.tipoTransaccion}</td>`+`<td class="${t.tipoTransaccionID===1?"info--positive":"info--negative"}"> ${t.tipoTransaccionID===1?"$":"-$"}${currency(t.monto)}</td>`+`<td>${moment(t.fechaOperacion).format("YYYY-MM-DD")}</td>`+`<td>${moment(t.fechaOperacion).format("LTS")}</td>`+"<\/tr>")}),swal.close()):requestError(n.message)}).catch(n=>{serviceError(`${n.status} - ${n.statusText}`)})},registrarTransaccion=()=>{let n={cuentaID:$("#cuentaID").val(),tipoTransaccionID:$("#tipoTransaccion").val(),monto:$("#monto").val().replace(",","")};transaccionRepository.httpGet("Registrar",n).then(n=>{n.correct?swal({icon:"success",title:"Transacción registrada",text:"La transacción fue registrada correctamente",buttons:!1,closeOnClickOutside:!1,closeOnEsc:!1,timer:1500}).then(()=>{processing("Actualizando el saldo de la cuenta..."),setTimeout(function(){obtenerCuenta();obtenerTransacciones()},1e3)}):requestError(n.message)}).catch(n=>{serviceError(`${n.status} - ${n.statusText}`)})};$(function(){moment.tz.setDefault("America/Mexico_City");parseInt($("#cuentaID").val())>0&&(waiting(),setTimeout(function(){obtenerCuenta();$(".transaction").prop("disabled",!1)},1500));$("#monto").mask("000,000,000,000,000.00",{reverse:!0});$(".transaction").on("click",function(){mostrarModal($(this).data("tipo"))});$("#cancelar").on("click",function(){clearInputs();$(".modal").toggleClass("visible")});$("#guardar").on("click",function(){parseInt($("#montoCuenta").val())>0?($(".modal").toggleClass("visible"),registrarTransaccion()):parseInt($("#montoCuenta").val())===0?info("No se puede realizar la transacción","La cantidad no puede ser igual a 0"):info("No se puede realizar la transacción","No es posible ingresar una cantidad negativa")})});